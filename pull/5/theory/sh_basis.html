
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; Python  documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/css/dipy.css?v=80c83778" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../_static/styles/grg-sphinx-theme.css"/>

    <script src="../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'theory/sh_basis';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">




  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Python  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org.html">
          Quick Start
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/tutorials.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/cli.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/reference.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/cli/reference.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2024">
          DIPY Workshop 2024
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2023">
          DIPY Workshop 2023
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2022">
          DIPY Workshop 2022
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2021">
          DIPY Workshop 2021
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2020">
          DIPY Workshop 2020
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2019">
          DIPY Workshop 2019
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="">
          Newsletters
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../blog.html">
          Blog
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="blog">
          Youtube
        </a>
      </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link " href="../.html">
          Live Chat (Gitter)
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="">
          Github Discussions
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link " href="../team.html">
          Team
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../releases.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org.html">
          Quick Start
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/tutorials.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/cli.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/reference.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../https%3A//docs.dipy.org/cli/reference.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2024">
          DIPY Workshop 2024
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2023">
          DIPY Workshop 2023
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2022">
          DIPY Workshop 2022
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2021">
          DIPY Workshop 2021
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2020">
          DIPY Workshop 2020
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="https://dipy.org/workshops/dipy-workshop-2019">
          DIPY Workshop 2019
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="">
          Newsletters
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../blog.html">
          Blog
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="blog">
          Youtube
        </a>
      </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link " href="../.html">
          Live Chat (Gitter)
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link nav-external" href="">
          Github Discussions
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link " href="../team.html">
          Team
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../releases.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link " href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<section id="spherical-harmonic-bases">
<span id="sh-basis"></span><h1>Spherical Harmonic bases<a class="headerlink" href="#spherical-harmonic-bases" title="Link to this heading">#</a></h1>
<p>Spherical Harmonics (SH) are functions defined on the sphere. A collection of
SH can be used as a basis function to represent and reconstruct any function on
the surface of a unit sphere.</p>
<p>Spherical harmonics are orthonormal functions defined by:</p>
<div class="math notranslate nohighlight">
\[Y_l^m(\theta, \phi) = \sqrt{\frac{2l + 1}{4 \pi} \frac{(l - m)!}{(l + m)!}} P_l^m( cos \theta) e^{i m \phi}\]</div>
<p>where <span class="math notranslate nohighlight">\(l\)</span> is the order, <span class="math notranslate nohighlight">\(m\)</span> is the degree, <span class="math notranslate nohighlight">\(P_l^m\)</span> is an associated
<span class="math notranslate nohighlight">\(l\)</span>-th order, <span class="math notranslate nohighlight">\(m\)</span>-th degree Legendre polynomial, and <span class="math notranslate nohighlight">\((\theta, \phi)\)</span> is the
representation of the direction vector in spherical coordinates. The relation
between <span class="math notranslate nohighlight">\(Y_l^{m}\)</span> and <span class="math notranslate nohighlight">\(Y_l^{-m}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[Y_l^{-m}(\theta, \phi) = (-1)^m \overline{Y_l^m}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{Y_l^m}\)</span> is the complex conjugate of <span class="math notranslate nohighlight">\(Y_l^m\)</span> defined as
<span class="math notranslate nohighlight">\(\overline{Y_l^m} = \Re(Y_l^m) - \Im(Y_l^m)\)</span>.</p>
<p>A function <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> can be represented using a spherical harmonics
basis using the spherical harmonics coefficients <span class="math notranslate nohighlight">\(a_l^m\)</span>, which can be
computed using the expression:</p>
<div class="math notranslate nohighlight">
\[a_l^m = \int_S f(\theta, \phi) Y_l^m(\theta, \phi) ds\]</div>
<p>Once the coefficients are computed, the function <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> can be
computed as:</p>
<div class="math notranslate nohighlight">
\[f(\theta, \phi) = \sum_{l = 0}^{\infty} \sum_{m = -l}^{l} a^m_l Y_l^m(\theta, \phi)\]</div>
<p>In HARDI, the Orientation Distribution Function (ODF) is a function on the
sphere. Therefore, SH functions offer the ideal framework for reconstructing
the ODF. Descoteaux <em>et al.</em> <a class="footnote-reference brackets" href="#id10" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> use the Q-Ball Imaging (QBI) formalization
to recover the ODF, while Tournier <em>et al.</em> <a class="footnote-reference brackets" href="#id11" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> use the Spherical Deconvolution
(SD) framework.</p>
<p>Several modified SH bases have been proposed in the diffusion imaging literature
for the computation of the ODF. DIPY implements two of these in the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">shm</span></code> module. Below are the formal definitions taken
directly from the literature.</p>
<ul class="simple">
<li><p>The basis proposed by Descoteaux <em>et al.</em> <a class="footnote-reference brackets" href="#id10" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \sqrt{2} \Re(Y_l^{m}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \sqrt{2} \Im(Y_l^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<ul class="simple">
<li><p>The basis proposed by Tournier <em>et al.</em> <a class="footnote-reference brackets" href="#id11" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \Im(Y_l^{m}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \Re(Y_{l}^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<p>In both cases, <span class="math notranslate nohighlight">\(\Re\)</span> denotes the real part of the spherical harmonic basis, and
<span class="math notranslate nohighlight">\(\Im\)</span> denotes the imaginary part. The SH bases are both orthogonal and real. Moreover,
the <cite>descoteaux07</cite> basis is orthonormal.</p>
<p>In both cases, <span class="math notranslate nohighlight">\(\Re\)</span> denotes the real part of the SH basis, and <span class="math notranslate nohighlight">\(\Im\)</span> denotes
the imaginary part. By alternately selecting the real or imaginary part of the
original SH basis, the modified SH bases have the properties of being both
orthogonal and real. Moreover, due to the presence of the <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> factor,
the basis proposed by Descoteaux <em>et al.</em> is orthonormal.</p>
<p>The SH bases implemented in DIPY for versions 1.2 and below differ slightly
from the literature. Their implementation is given below.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> basis is based on the one proposed by Descoteaux <em>et al.</em>
<a class="footnote-reference brackets" href="#id10" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> and is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \sqrt{2} \Re(Y_l^{|m|}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \sqrt{2} \Im(Y_l^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> basis is based on the one proposed by Tournier <em>et al.</em>
<a class="footnote-reference brackets" href="#id11" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \Im(Y_l^{|m|}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \Re(Y_{l}^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<p>These bases differ from the literature by the presence of an absolute value around
<span class="math notranslate nohighlight">\(m\)</span> when <span class="math notranslate nohighlight">\(m &lt; 0\)</span>. Due to relations <span class="math notranslate nohighlight">\(-p = |p| ; \forall p &lt; 0\)</span> and
<span class="math notranslate nohighlight">\(Y_l^{-m}(\theta, \phi) = (-1)^m \overline{Y_l^m}\)</span>, the effect of this change is a
sign flip for the SH functions of even degree <span class="math notranslate nohighlight">\(m &lt; 0\)</span>. This has no effect on the
mathematical properties of each basis.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> SH basis defined above is the basis used in MRtrix 0.2 <a class="footnote-reference brackets" href="#id12" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.
However, the omission of the <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> factor seen in the basis from Descoteaux
<em>et al.</em> <a class="footnote-reference brackets" href="#id10" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> makes it non-orthonormal. For this reason, the MRtrix3 <a class="footnote-reference brackets" href="#id13" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> SH
basis uses a new basis including the normalization factor.</p>
<p>Since DIPY 1.3, the <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> and <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> SH bases have been
updated in order to agree with the literature and the latest MRtrix3
implementation. While previous bases are still available as <em>legacy</em> bases,
the <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> and <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> bases now default to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \sqrt{2} \Re(Y_l^{m}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \sqrt{2} \Im(Y_l^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<p>for the <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> basis and</p>
<div class="math notranslate nohighlight">
\[\begin{split}Y_i(\theta, \phi) =
 \begin{cases}
 \sqrt{2} \Im(Y_l^{|m|}(\theta, \phi)) &amp; -l \leq m &lt; 0, \\
 Y_l^0(\theta, \phi) &amp; m = 0, \\
 \sqrt{2} \Re(Y_{l}^m(\theta, \phi)) &amp; 0 &lt; m \leq l
 \end{cases}\end{split}\]</div>
<p>for the <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> basis. Both bases are very similar, with their only
difference being the sign of <span class="math notranslate nohighlight">\(m\)</span> for which the imaginary and real parts of
the spherical harmonic <span class="math notranslate nohighlight">\(Y_{l}^m\)</span> are used.</p>
<p>In practice, a maximum order <span class="math notranslate nohighlight">\(k\)</span> is used to truncate the SH series. By
only taking into account even order SH functions, the above bases can be used
to reconstruct symmetric spherical functions. The choice of an even order is
motivated by the symmetry of the diffusion process around the origin.</p>
<p>Both bases are also available as full SH bases, where odd order SH functions
are also taken into account when reconstructing a spherical function. These
full bases can successfully reconstruct asymmetric signals as well as
symmetric signals.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>,<a role="doc-backlink" href="#id5">3</a>,<a role="doc-backlink" href="#id8">4</a>)</span>
<p>Descoteaux, M., Angelino, E., Fitzgibbons, S. and Deriche, R.
Regularized, Fast, and Robust Analytical Q‐ball Imaging.
Magn. Reson. Med. 2007;58:497-510.</p>
</aside>
<aside class="footnote brackets" id="id11" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>,<a role="doc-backlink" href="#id6">3</a>)</span>
<p>Tournier J.D., Calamante F. and Connelly A. Robust determination
of the fibre orientation distribution in diffusion MRI:
Non-negativity constrained super-resolved spherical deconvolution.
NeuroImage. 2007;35(4):1459–1472.</p>
</aside>
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">3</a><span class="fn-bracket">]</span></span>
<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,
Pietsch M, et al. MRtrix3: A fast, flexible and open software
framework for medical image processing and visualisation.
NeuroImage. 2019 Nov 15;202:116-137.</p>
</aside>
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">4</a><span class="fn-bracket">]</span></span>
<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,
Pietsch M, et al. MRtrix3: A fast, flexible and open software
framework for medical image processing and visualisation.
NeuroImage. 2019 Nov 15;202:116-137.</p>
</aside>
</aside>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>